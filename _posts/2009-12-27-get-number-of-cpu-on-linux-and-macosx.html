---
layout: post
title: "리눅스 / 맥오에스에서 CPU 갯수 얻기"
date: 2009-12-27 16:23:30.000000000 +09:00
categories:
- "카스탈리엔"
tags:
- glibc
- Linux
- MacOSX
status: publish
type: post
published: true
meta:
  _publicize_pending: '1'
  lightboxoff: 'false'
  _edit_last: '3788329'
  original_post_id: '1177'
  _wp_old_slug: '1177'
author:
  login: fan4326
  email: fan4326@gmail.com
  display_name: fan4326
  first_name: ''
  last_name: ''
---
<p>Linux / MacOS X 플랫폼에서 CPU 갯수를 얻어오는 함수입니다. 잊어버릴까봐 기록해 둡니다.</p>
<pre>#include &lt;stdio.h&gt;
#ifdef __linux__
#include &lt;sys/sysinfo.h&gt;
#else
#ifdef __APPLE__
#include &lt;sys/param.h&gt;
#include &lt;sys/sysctl.h&gt;
#else
#error "Only Linux or OSX is supported!"
#endif /* __APPLE__ */
#endif /* __linux__ */

static int
get_cpu_nr (void)
{
#ifdef __linux__
  return get_nprocs ();
#endif
#ifdef __APPLE__
  int i = 0;
  size_t s = sizeof (i);
  if (sysctlbyname ("hw.ncpu", &amp;i, &amp;s, NULL, 0))
    return 1;
  return i;
#endif
}

int
main (int argc, char **argv)
{
  printf ("cpu_nr:%dn", get_cpu_nr ());

  return 0;
}</pre>
<p>출처는 <a href="http://github.com/chergert/dukes_of_hazard/raw/master/main.c">이 소스</a>입니다. 참고로 리눅스의 <code>/usr/include/sys/sysinfo.h</code> 파일을 들여다보면 램 크기 / 스왑 크기 / 물리 페이지 크기 등과 같은 시스템 관련 정보를 얻을 수 있는 함수가 여럿 보이는군요. <code>/proc</code> 정보를 파싱하는 것보다 더 편리할 것 같습니다.</p>
